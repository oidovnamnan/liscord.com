# 📋 LISCORD — ДЭЛГЭРЭНГҮЙ ХӨГЖҮҮЛЭЛТИЙН ТӨЛӨВЛӨГӨӨ
## Бүх модулийг нэг бүрчлэн нарийн задалсан

---

## 🏗️ ПЛАТФОРМЫН ЕРӨНХИЙ БҮТЭЦ

```
LISCORD ПЛАТФОРМ (Multi-tenant SaaS)
│
├── 🌐 Нийтийн хэсэг (Public)
│   ├── Landing page (liscord.com)
│   ├── Үнийн хуудас
│   ├── Нэвтрэх / Бүртгүүлэх
│   └── Нийтийн tracking хуудас
│
└── 🔒 Апп хэсэг (Authenticated)
    │
    └── Бизнес #1 (Tenant)
    │   ├── Эзэн (Owner) — бүх эрхтэй
    │   ├── Албан тушаалууд (Positions)
    │   │   ├── "Менежер" → [эрхүүдийн багц]
    │   │   ├── "Нярав" → [эрхүүдийн багц]
    │   │   └── "Хүргэгч" → [эрхүүдийн багц]
    │   ├── Ажилчид (Employees)
    │   │   ├── Хэрэглэгч A → Менежер
    │   │   ├── Хэрэглэгч B → Нярав
    │   │   └── Хэрэглэгч C → Хүргэгч
    │   ├── Захиалгууд (ангилалд тохирсон)
    │   ├── Харилцагчид
    │   ├── Бараанууд (ангилалд тохирсон)
    │   ├── Dashboard (ангилалд тохирсон KPI)
    │   └── Тохиргоо
    │
    └── Бизнес #2 (Tenant) — тус тусдаа, бие биедээ нөлөөлөхгүй
        └── ...
```

---

## 📦 МОДУЛЬ 1: НЭВТРЭЛТ & ХЭРЭГЛЭГЧИЙН БҮРТГЭЛ (Auth)

### 1.1 Функцууд

| # | Функц | Тайлбар |
|---|-------|---------|
| 1.1.1 | Утасны дугаараар бүртгүүлэх | +976 форматтай, OTP баталгаажуулалт |
| 1.1.2 | И-мэйлээр бүртгүүлэх | И-мэйл + нууц үг |
| 1.1.3 | Нэвтрэх | Утас эсвэл и-мэйлээр |
| 1.1.4 | Нууц үг сэргээх | И-мэйлээр reset линк |
| 1.1.5 | Профайл засах | Нэр, зураг, утас, и-мэйл |
| 1.1.6 | Нууц үг солих | Хуучин + шинэ нууц үг |
| 1.1.7 | Гарах (Logout) | Сессн хаах |
| 1.1.8 | Олон бизнест хамаарах | 1 хэрэглэгч олон бизнест ажилтан байж болно |

### 1.2 Мэдээллийн бүтэц

```javascript
// Firestore: users/{userId}
{
  uid: "firebase_uid",
  name: "Бат-Эрдэнэ",
  phone: "+97699001234",
  email: "bat@email.com",
  avatar: "https://storage.../avatar.jpg",  // Firebase Storage URL
  
  // Бизнесүүд (олон бизнест хамаарч болно)
  businesses: [
    {
      businessId: "biz_abc123",
      businessName: "Эрээн Карго",
      positionId: "pos_manager",         // Албан тушаал
      positionName: "Менежер",
      role: "employee",                   // "owner" | "employee"
      joinedAt: Timestamp,
      isActive: true
    },
    {
      businessId: "biz_xyz789",
      businessName: "Хувцас Шоп",
      positionId: "pos_owner",
      positionName: "Эзэн",
      role: "owner",
      joinedAt: Timestamp,
      isActive: true
    }
  ],
  
  activeBusiness: "biz_abc123",          // Одоо идэвхтэй бизнес
  
  settings: {
    language: "mn",                       // "mn" | "en"
    theme: "dark",                        // "dark" | "light"
    notifications: {
      push: true,
      email: false,
      sms: false
    }
  },
  
  createdAt: Timestamp,
  lastLoginAt: Timestamp
}
```

### 1.3 Дэлгэцүүд

#### Дэлгэц 1.3.1: Нэвтрэх (/login)
```
┌──────────────────────────────────┐
│                                  │
│         LISCORD logo             │
│    "Бизнесээ хялбар удирдаарай"  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 📱 Утасны дугаар          │  │
│  │ +976 ________             │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 🔒 Нууц үг               │  │
│  │ ••••••••                  │  │
│  └────────────────────────────┘  │
│                                  │
│  [      Нэвтрэх (Button)      ] │
│                                  │
│  ── эсвэл ──                    │
│                                  │
│  [  📧 И-мэйлээр нэвтрэх     ] │
│                                  │
│  Бүртгэлгүй юу? [Бүртгүүлэх]   │
│  Нууц үгээ мартсан? [Сэргээх]   │
│                                  │
└──────────────────────────────────┘
```

#### Дэлгэц 1.3.2: Бүртгүүлэх (/register)
```
┌──────────────────────────────────┐
│        Бүртгүүлэх                │
│                                  │
│  Алхам 1/3: Хувийн мэдээлэл     │
│  ┌────────────────────────────┐  │
│  │ Нэр *                     │  │
│  │ Бат-Эрдэнэ                │  │
│  └────────────────────────────┘  │
│  ┌────────────────────────────┐  │
│  │ Утасны дугаар *            │  │
│  │ +976 9900 1234             │  │
│  └────────────────────────────┘  │
│  ┌────────────────────────────┐  │
│  │ И-мэйл (заавал биш)       │  │
│  └────────────────────────────┘  │
│  ┌────────────────────────────┐  │
│  │ Нууц үг *                 │  │
│  └────────────────────────────┘  │
│  ┌────────────────────────────┐  │
│  │ Нууц үг давтах *          │  │
│  └────────────────────────────┘  │
│                                  │
│  [       Үргэлжлүүлэх         ] │
│                                  │
│  Бүртгэлтэй юу? [Нэвтрэх]      │
└──────────────────────────────────┘

→ Алхам 2/3: OTP баталгаажуулалт
→ Алхам 3/3: Бизнес үүсгэх эсвэл урилгаар нэгдэх
```

### 1.4 Бизнес логик
- Утасны дугаар давтагдаж болохгүй (unique)
- Нууц үг: 8+ тэмдэгт
- OTP: 6 оронтой, 3 минутын хугацаатай, 3 удаа оролдох
- Нэвтрэлтийн token: Firebase Auth JWT

---

## 📦 МОДУЛЬ 2: БИЗНЕС УДИРДЛАГА

### 2.1 Функцууд

| # | Функц | Тайлбар |
|---|-------|---------|
| 2.1.1 | Бизнес үүсгэх | Нэр, ангилал, лого, бусад мэдээлэл |
| 2.1.2 | Бизнесийн мэдээлэл засах | Нэр, лого, хаяг, утас |
| 2.1.3 | Бизнесийн ангилал сонгох | 10+1 ангилалаас сонгох |
| 2.1.4 | Бизнес хооронд шилжих | Олон бизнестэй хэрэглэгч шилжих |
| 2.1.5 | Бизнес устгах | Эзэн л устгаж чадна (PIN + баталгаажуулалт) |
| 2.1.6 | Бизнесийн тохиргоо | Валют, цагийн бүс, захиалгын угтвар |

### 2.2 Мэдээллийн бүтэц

```javascript
// Firestore: businesses/{businessId}
{
  id: "biz_abc123",
  name: "Эрээн Карго",
  category: "cargo_import",         // Ангилалын ID
  
  // Бизнесийн мэдээлэл
  profile: {
    logo: "https://storage.../logo.jpg",
    phone: "+97677001234",
    email: "info@cargo.mn",
    address: "УБ, БЗД, 3-р хороо, ...",
    website: "",
    description: "Хятадаас бараа тээвэрлэх үйлчилгээ",
    socialLinks: {
      facebook: "",
      instagram: ""
    }
  },
  
  // Тохиргоо
  settings: {
    currency: "MNT",
    timezone: "Asia/Ulaanbaatar",
    language: "mn",
    
    // Захиалгын тохиргоо
    order: {
      prefix: "ORD",                 // Захиалгын дугаарын угтвар
      nextNumber: 1,                 // Дараагийн дугаар
      autoNumber: true,
      requirePin: true,              // Устгахад PIN шаардах
      pin: "1234",                   // 4 оронтой PIN (hashed)
    },
    
    // Мэдэгдлийн тохиргоо
    notifications: {
      newOrder: true,
      orderStatusChange: true,
      lowStock: true,
      paymentReceived: true
    }
  },
  
  // Ангилалд тусгай тохиргоо
  categoryConfig: {
    // ... BUSINESS_CATEGORIES.md-д тодорхойлсон
  },
  
  // Статистик (denormalized, cloud function-ээр шинэчлэгдэнэ)
  stats: {
    totalOrders: 1542,
    totalRevenue: 45000000,
    totalCustomers: 320,
    totalProducts: 150,
    totalEmployees: 5,
    activeEmployees: 4
  },
  
  // Төлбөрийн багц
  subscription: {
    plan: "free",                    // "free" | "pro" | "business"
    expiresAt: null,
    maxEmployees: 1,                 // free: 1, pro: 5, business: 20
    maxOrdersPerMonth: 100,          // free: 100, pro: unlimited
    maxProducts: 50                  // free: 50, pro: unlimited
  },
  
  ownerId: "user_xyz",              // Эзний user ID
  createdAt: Timestamp,
  updatedAt: Timestamp,
  isActive: true
}
```

### 2.3 Бизнес үүсгэх Flow

```
Алхам 1: Бизнесийн нэр
┌──────────────────────────────────┐
│   🏢 Бизнесийнхээ нэрийг оруулна│
│                                  │
│  ┌────────────────────────────┐  │
│  │ Бизнесийн нэр *            │  │
│  │ Эрээн Карго                │  │
│  └────────────────────────────┘  │
│                                  │
│  [       Үргэлжлүүлэх         ] │
└──────────────────────────────────┘

Алхам 2: Ангилал сонгох
┌──────────────────────────────────┐
│   Бизнесийнхээ төрлийг сонгоно уу│
│                                  │
│  ┌──────────┐ ┌──────────┐      │
│  │ 📦       │ │ 🏪       │      │
│  │ Карго /  │ │ Бөөний   │      │
│  │ Импорт   │ │ Худалдаа │      │
│  └──────────┘ └──────────┘      │
│  ┌──────────┐ ┌──────────┐      │
│  │ 📱       │ │ 🍔       │      │
│  │ Онлайн / │ │ Хоол /   │      │
│  │ Сошиал   │ │ Хүргэлт  │      │
│  └──────────┘ └──────────┘      │
│  ┌──────────┐ ┌──────────┐      │
│  │ 🔧       │ │ 🖨️       │      │
│  │ Засвар   │ │ Хэвлэл   │      │
│  └──────────┘ └──────────┘      │
│  ...                             │
│  ┌──────────┐                    │
│  │ 📋       │                    │
│  │ Ерөнхий  │                    │
│  └──────────┘                    │
│                                  │
│  [       Үргэлжлүүлэх         ] │
└──────────────────────────────────┘

Алхам 3: Нэмэлт мэдээлэл (optional)
- Лого upload
- Утас, хаяг
- Захиалгын дугаарын угтвар

Алхам 4: Бэлэн!
→ /app/dashboard руу шилжинэ
→ Анхны default албан тушаалууд автомат үүснэ
```

---

## 📦 МОДУЛЬ 3: ЭРХ & ЗӨВШӨӨРЛИЙН СИСТЕМ (Permissions)

> **Гол зарчим:** Эрх (Permission) → Албан тушаал (Position) → Ажилтан (Employee)
> Атомар эрхүүдийг бүлэглэж албан тушаал үүсгэнэ. Ажилтан албан тушаалтай холбогдоно.

### 3.1 Бүх эрхүүдийн жагсаалт (Permissions)

Эрхүүд нь **модуль.үйлдэл** форматтай. Нийт ~60 эрх.

#### 3.1.1 Захиалгын эрхүүд (orders.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `orders.view_own` | Өөрийн захиалга харах | Зөвхөн өөрийн үүсгэсэн захиалгыг харна |
| `orders.view_all` | Бүх захиалга харах | Бүх захиалгыг харна |
| `orders.create` | Захиалга үүсгэх | Шинэ захиалга нэмэх |
| `orders.edit_own` | Өөрийн захиалга засах | Өөрийн үүсгэсэн захиалгыг засна |
| `orders.edit_all` | Бүх захиалга засах | Аль ч захиалгыг засна |
| `orders.delete` | Захиалга устгах | PIN-тэй устгах |
| `orders.change_status` | Статус өөрчлөх | Захиалгын статус солих |
| `orders.assign` | Захиалга хуваарилах | Ажилтанд хуваарилах |
| `orders.export` | Экспортлох | CSV/Excel татах |
| `orders.view_financials` | Мөнгөн дүн харах | Үнэ, төлбөр, ашиг харах |
| `orders.manage_payments` | Төлбөр удирдах | Төлбөр бүртгэх, засах |
| `orders.bulk_actions` | Бөөнөөр үйлдэл | Олон захиалга зэрэг засах |

#### 3.1.2 Харилцагчийн эрхүүд (customers.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `customers.view` | Харилцагч харах | Харилцагчийн жагсаалт, дэлгэрэнгүй |
| `customers.create` | Харилцагч нэмэх | Шинэ харилцагч бүртгэх |
| `customers.edit` | Харилцагч засах | Мэдээлэл өөрчлөх |
| `customers.delete` | Харилцагч устгах | Устгах (PIN-тэй) |
| `customers.view_history` | Түүх харах | Захиалгын түүх, тооцоо |
| `customers.export` | Экспортлох | CSV/Excel |
| `customers.view_financials` | Тооцоо харах | Авлага, өглөг, тооцоо |

#### 3.1.3 Барааны эрхүүд (products.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `products.view` | Бараа харах | Барааны жагсаалт |
| `products.create` | Бараа нэмэх | Шинэ бараа бүртгэх |
| `products.edit` | Бараа засах | Нэр, үнэ, зураг засах |
| `products.delete` | Бараа устгах | Устгах |
| `products.view_cost` | Өртөг харах | Өртгийн үнэ (нууц мэдээлэл) |
| `products.manage_stock` | Нөөц удирдах | Нөөцийн тоо нэмэх/хасах |
| `products.manage_categories` | Ангилал удирдах | Ангилал нэмэх/засах/устгах |
| `products.manage_pricing` | Үнэ удирдах | Үнэ өөрчлөх, хямдрал тохируулах |

#### 3.1.4 Dashboard & Тайлангийн эрхүүд (reports.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `reports.view_dashboard` | Dashboard харах | Хяналтын самбар |
| `reports.view_sales` | Борлуулалтын тайлан | Борлуулалтын нэгтгэл |
| `reports.view_revenue` | Орлогын тайлан | Орлого, ашиг |
| `reports.view_inventory` | Нөөцийн тайлан | Барааны нөөц |
| `reports.view_customers` | Харилцагчийн тайлан | Топ харилцагч гэх мэт |
| `reports.export` | Тайлан экспортлох | PDF, Excel |

#### 3.1.5 Багийн эрхүүд (team.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `team.view` | Ажилтан харах | Ажилтнуудын жагсаалт |
| `team.invite` | Ажилтан урих | Урилга илгээх |
| `team.edit` | Ажилтан засах | Мэдээлэл, албан тушаал өөрчлөх |
| `team.remove` | Ажилтан хасах | Бизнесээс хасах |
| `team.manage_positions` | Албан тушаал удирдах | Албан тушаал үүсгэх/засах/устгах |
| `team.manage_permissions` | Эрх удирдах | Албан тушаалын эрх өөрчлөх |
| `team.view_activity` | Идэвхжил харах | Хэн юу хийсэн лог |

#### 3.1.6 Тохиргооны эрхүүд (settings.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `settings.view` | Тохиргоо харах | Бизнесийн тохиргоо |
| `settings.edit_business` | Бизнес мэдээлэл засах | Нэр, лого, хаяг |
| `settings.edit_orders` | Захиалгын тохиргоо | Угтвар, статус, PIN |
| `settings.edit_notifications` | Мэдэгдэл тохируулах | Push, SMS тохиргоо |
| `settings.manage_billing` | Төлбөр удирдах | Багц шилжүүлэх, төлбөр |
| `settings.edit_category_config` | Ангилалын тохиргоо | Тусгай талбарууд тохируулах |
| `settings.manage_custom_fields` | Custom field удирдах | Нэмэлт талбар үүсгэх/засах |
| `settings.manage_statuses` | Статус удирдах | Статусууд нэмэх/засах |

#### 3.1.7 Мэдэгдлийн эрхүүд (notifications.*)
| Эрхийн ID | Нэр (MN) | Тайлбар |
|-----------|----------|---------|
| `notifications.receive_new_order` | Шинэ захиалга мэдэгдэл | Шинэ захиалга ирэхэд |
| `notifications.receive_status_change` | Статус өөрчлөлт | Захиалгын статус өөрчлөгдөхөд |
| `notifications.receive_payment` | Төлбөр мэдэгдэл | Төлбөр бүртгэгдэхэд |
| `notifications.receive_low_stock` | Нөөц бага мэдэгдэл | Нөөц доод хязгаарт хүрэхэд |

### 3.2 Мэдээллийн бүтэц (Permissions & Positions)

```javascript
// Firestore: businesses/{businessId}/positions/{positionId}
{
  id: "pos_manager",
  name: "Менежер",
  description: "Захиалга, харилцагч, бараа бүрэн удирдах",
  color: "#8B5CF6",                  // Өнгө (UI-д харагдах)
  icon: "👔",
  
  // Эрхүүдийн жагсаалт
  permissions: [
    "orders.view_all",
    "orders.create",
    "orders.edit_all",
    "orders.change_status",
    "orders.assign",
    "orders.view_financials",
    "orders.manage_payments",
    "orders.export",
    "orders.bulk_actions",
    "customers.view",
    "customers.create",
    "customers.edit",
    "customers.view_history",
    "customers.view_financials",
    "products.view",
    "products.edit",
    "products.manage_stock",
    "reports.view_dashboard",
    "reports.view_sales",
    "notifications.receive_new_order",
    "notifications.receive_status_change",
    "notifications.receive_payment"
  ],
  
  isDefault: true,                   // Анхны default тушаал уу
  isSystem: false,                   // Системийн тушаал (устгаж болохгүй)
  employeeCount: 3,                  // Энэ тушаалтай хэдэн ажилтан байгаа
  createdAt: Timestamp,
  updatedAt: Timestamp,
  createdBy: "user_xyz"
}
```

### 3.3 Ангилал бүрийн Default албан тушаалууд

Бизнес шинээр үүсэхэд ангилалаас хамааран **анхны default** албан тушаалууд автомат үүсдэг.

#### Бүх ангилалд нийтлэг:
| Тушаал | Эрхүүд | Тайлбар |
|--------|--------|---------|
| **Эзэн (Owner)** | БҮХ ЭРХ | Системийн тушаал, устгаж/засаж болохгүй |

#### A. Карго/Импорт default:
| Тушаал | Гол эрхүүд |
|--------|-----------|
| Менежер | Бүх захиалга + харилцагч + тайлан |
| Агуулахын ажилтан | Захиалга харах + статус солих + нөөц |
| Бүртгэгч | Захиалга үүсгэх + харилцагч нэмэх |
| Хүргэгч | Өөрийн хуваарилагдсан захиалга харах + статус солих |

#### B. Бөөний худалдаа default:
| Тушаал | Гол эрхүүд |
|--------|-----------|
| Борлуулалтын менежер | Бүх захиалга + харилцагч + тооцоо + тайлан |
| Нярав | Бараа + нөөц + захиалга харах |
| Борлуулагч | Захиалга үүсгэх + харилцагч + бараа харах |
| Нягтлан | Тооцоо + тайлан + төлбөр (захиалга засахгүй) |

#### C. Онлайн/Сошиал default:
| Тушаал | Гол эрхүүд |
|--------|-----------|
| Менежер | Бүх эрх (эзнээс бусад) |
| Захиалга хариуцагч | Захиалга + харилцагч + статус |
| Хүргэгч | Хүргэлтийн захиалга + статус |

#### D. Хоол/Хүргэлт default:
| Тушаал | Гол эрхүүд |
|--------|-----------|
| Менежер | Бүх эрх (эзнээс бусад) |
| Кассчин | Захиалга үүсгэх + төлбөр |
| Тогооч | Захиалга харах + статус солих (бэлтгэж байна→бэлэн) |
| Хүргэгч | Хүргэлтийн захиалга + статус |

#### E. Засвар default:
| Тушаал | Гол эрхүүд |
|--------|-----------|
| Менежер | Бүх эрх |
| Техникч | Захиалга харах + засах + статус + сэлбэг |
| Хүлээн авагч | Захиалга үүсгэх + харилцагч |

#### F-J ангилалууд: Адил зарчмаар тухайн ангилалд тохирсон default тушаалууд.

### 3.4 Дэлгэцүүд

#### Дэлгэц 3.4.1: Албан тушаалын жагсаалт (/app/settings/positions)
```
┌──────────────────────────────────────────┐
│  ⚙️ Тохиргоо > Албан тушаалууд          │
│                                          │
│  [+ Шинэ албан тушаал]                   │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 👑 Эзэн               🔒 Системийн│  │
│  │ Бүх эрхтэй                        │  │
│  │ 1 хүн                              │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 👔 Менежер              [✏️] [🗑️] │  │
│  │ 45 эрх идэвхтэй                   │  │
│  │ 3 хүн                              │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 📦 Нярав                [✏️] [🗑️] │  │
│  │ 20 эрх идэвхтэй                   │  │
│  │ 2 хүн                              │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 🚚 Хүргэгч              [✏️] [🗑️] │  │
│  │ 8 эрх идэвхтэй                    │  │
│  │ 4 хүн                              │  │
│  └────────────────────────────────────┘  │
└──────────────────────────────────────────┘
```

#### Дэлгэц 3.4.2: Албан тушаал засах — Эрх тохируулах
```
┌──────────────────────────────────────────┐
│  ← Буцах   Менежер — Эрх тохируулах     │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ Тушаалын нэр: [Менежер          ] │  │
│  │ Тайлбар:      [Бүрэн удирдлага  ] │  │
│  │ Өнгө:         🟣                  │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ── 📋 Захиалга ──────────────────────   │
│  ✅ Бүх захиалга харах                   │
│  ✅ Захиалга үүсгэх                      │
│  ✅ Бүх захиалга засах                   │
│  ✅ Статус өөрчлөх                       │
│  ✅ Захиалга хуваарилах                  │
│  ☐  Захиалга устгах                     │
│  ✅ Мөнгөн дүн харах                     │
│  ✅ Төлбөр удирдах                       │
│  ✅ Экспортлох                           │
│  ✅ Бөөнөөр үйлдэл                      │
│                                          │
│  ── 👥 Харилцагч ─────────────────────   │
│  ✅ Харилцагч харах                      │
│  ✅ Харилцагч нэмэх                      │
│  ✅ Харилцагч засах                      │
│  ☐  Харилцагч устгах                    │
│  ✅ Түүх харах                           │
│  ✅ Тооцоо харах                         │
│                                          │
│  ── 🛍️ Бараа ────────────────────────   │
│  ✅ Бараа харах                          │
│  ☐  Бараа нэмэх                         │
│  ✅ Бараа засах                          │
│  ☐  Бараа устгах                         │
│  ☐  Өртөг харах                          │
│  ✅ Нөөц удирдах                         │
│                                          │
│  ── 📊 Тайлан ────────────────────────   │
│  ✅ Dashboard                            │
│  ✅ Борлуулалтын тайлан                  │
│  ☐  Орлогын тайлан                       │
│                                          │
│  ── 👥 Баг ───────────────────────────   │
│  ✅ Ажилтан харах                        │
│  ☐  Ажилтан урих                         │
│  ☐  Албан тушаал удирдах                 │
│                                          │
│  ── ⚙️ Тохиргоо ─────────────────────   │
│  ☐  Бизнес мэдээлэл засах               │
│  ☐  Төлбөр удирдах                       │
│                                          │
│  ── 🔔 Мэдэгдэл ─────────────────────   │
│  ✅ Шинэ захиалга                        │
│  ✅ Статус өөрчлөлт                      │
│  ✅ Төлбөр                               │
│  ☐  Нөөц бага                            │
│                                          │
│  [         Хадгалах            ]         │
└──────────────────────────────────────────┘
```

---

## 📦 МОДУЛЬ 4: АЖИЛТНЫ УДИРДЛАГА

### 4.1 Функцууд

| # | Функц | Хэн хийх | Тайлбар |
|---|-------|----------|---------|
| 4.1.1 | Ажилтан урих | team.invite эрхтэй | Утас/линкээр урилга илгээх |
| 4.1.2 | Урилга хүлээн авах | Урилга авсан хүн | Урилга зөвшөөрөх/татгалзах |
| 4.1.3 | Ажилтны жагсаалт | team.view | Бүх ажилтнуудыг харах |
| 4.1.4 | Ажилтны мэдээлэл харах | team.view | Дэлгэрэнгүй мэдээлэл |
| 4.1.5 | Тушаал өөрчлөх | team.edit | Ажилтны албан тушаал солих |
| 4.1.6 | Ажилтан идэвхгүй болгох | team.edit | Түр хугацаагаар идэвхгүй |
| 4.1.7 | Ажилтан хасах | team.remove | Бизнесээс бүрмөсөн хасах |
| 4.1.8 | Идэвхжилийн лог харах | team.view_activity | Хэн юу хийсэн |

### 4.2 Мэдээллийн бүтэц

```javascript
// Firestore: businesses/{businessId}/employees/{employeeId}
{
  id: "emp_abc123",
  userId: "user_xyz",                // users/ collection-тэй холбогдсон
  
  // Хувийн мэдээлэл (users-аас хуулагдсан / override)
  name: "Дорж",
  phone: "+97699112233",
  email: "dorj@email.com",
  avatar: "https://...",
  
  // Албан тушаал
  positionId: "pos_manager",
  positionName: "Менежер",            // Denormalized
  
  // Нэмэлт мэдээлэл
  employeeCode: "EMP-003",           // Ажилтны код (optional)
  department: "",                     // Хэлтэс (optional)
  startDate: Timestamp,              // Ажилд орсон огноо
  
  // Төлөв
  status: "active",                  // "active" | "inactive" | "pending_invite"
  
  // Урилгын мэдээлэл
  invitation: {
    invitedBy: "user_owner",
    invitedAt: Timestamp,
    inviteMethod: "phone",           // "phone" | "link"
    inviteCode: "INV-XY12",          // Урилгын код
    acceptedAt: Timestamp | null
  },
  
  // Статистик
  stats: {
    totalOrdersCreated: 156,
    totalOrdersHandled: 320,
    lastActiveAt: Timestamp
  },
  
  createdAt: Timestamp,
  updatedAt: Timestamp
}

// Firestore: businesses/{businessId}/invitations/{inviteId}
{
  id: "inv_abc",
  phone: "+97699112233",             // Урилга илгээсэн утас
  positionId: "pos_staff",
  positionName: "Бүртгэгч",
  inviteCode: "INV-XY12",
  invitedBy: "user_owner",
  invitedByName: "Бат-Эрдэнэ",
  status: "pending",                 // "pending" | "accepted" | "expired" | "cancelled"
  expiresAt: Timestamp,              // 7 хоногийн дараа дуусна
  createdAt: Timestamp
}
```

### 4.3 Ажилтан урих Flow

```
Эзэн/Менежер:
1. /app/settings/team → [+ Ажилтан урих] товчлуур
2. Modal нээгдэнэ:
   ┌──────────────────────────────────┐
   │       Ажилтан урих               │
   │                                  │
   │  Урих арга:                      │
   │  (●) Утасны дугаараар            │
   │  ( ) Урилгын линкээр             │
   │                                  │
   │  ┌────────────────────────────┐  │
   │  │ Утасны дугаар *            │  │
   │  │ +976 9911 2233             │  │
   │  └────────────────────────────┘  │
   │                                  │
   │  Албан тушаал: *                 │
   │  ┌────────────────────────────┐  │
   │  │ ▾ Менежер                  │  │
   │  │   Нярав                    │  │
   │  │   Бүртгэгч                 │  │
   │  │   Хүргэгч                  │  │
   │  └────────────────────────────┘  │
   │                                  │
   │  [   Урилга илгээх    ]         │
   └──────────────────────────────────┘

3. Урилга → invitations/ collection-д хадгалагдана
4. Тухайн утасны дугаартай хүн:
   a. Liscord-д бүртгэлтэй бол → Нэвтрэхэд урилгын мэдэгдэл харагдана
   b. Бүртгэлгүй бол → SMS-ээр урилга линк илгээгдэнэ
5. Хүлээн авагч зөвшөөрвөл → employees/ collection-д нэмэгдэнэ

Линкээр урих:
1. Урилгын линк үүсгэнэ: liscord.com/invite/INV-XY12
2. Линкийг хуваалцана (Messenger, SMS гэх мэт)
3. Хүн линк дээр дарахад → Бүртгүүлэх/Нэвтрэх → Бизнест нэгдэх
```

### 4.4 Дэлгэцүүд

#### Дэлгэц 4.4.1: Ажилтнуудын жагсаалт (/app/settings/team)
```
┌──────────────────────────────────────────┐
│  ⚙️ Тохиргоо > Ажилтнууд    [+ Урих]   │
│                                          │
│  Идэвхтэй (4)   Хүлээгдэж буй (1)      │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 👑 Бат-Эрдэнэ         Эзэн       │  │
│  │    +976 9900 1234                  │  │
│  │    Сүүлд идэвхтэй: Одоо          │  │
│  │    156 захиалга үүсгэсэн          │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 👔 Дорж                Менежер    │  │
│  │    +976 9911 2233      [✏️] [⛔]  │  │
│  │    Сүүлд идэвхтэй: 2 цагийн өмнө│  │
│  │    320 захиалга хариуцсан         │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 📦 Сараа               Нярав     │  │
│  │    +976 9922 3344      [✏️] [⛔]  │  │
│  │    Сүүлд идэвхтэй: Өчигдөр       │  │
│  └────────────────────────────────────┘  │
│                                          │
│  ── Хүлээгдэж буй урилга ─────────────  │
│  ┌────────────────────────────────────┐  │
│  │ ⏳ +976 9933 4455      Хүргэгч    │  │
│  │    Урилга: 2 цагийн өмнө         │  │
│  │    [Дахин илгээх] [Цуцлах]        │  │
│  └────────────────────────────────────┘  │
└──────────────────────────────────────────┘
```

### 4.5 Бизнес логик

#### Эрхийн шалгалт (Permission Check)
```javascript
// Жишээ: Хэрэглэгч захиалга устгах гэж байна
// 1. Хэрэглэгчийн бизнес дэх employee record авна
// 2. Employee-ийн positionId-аар position авна
// 3. Position-ийн permissions array-д "orders.delete" байгаа эсэхийг шалгана
// 4. Байвал → зөвшөөрнө, байхгүй бол → хориглоно

function hasPermission(userId, businessId, permission): boolean {
  const employee = getEmployee(businessId, userId);
  if (!employee || employee.status !== 'active') return false;
  if (employee.role === 'owner') return true; // Эзэн бүх эрхтэй
  
  const position = getPosition(businessId, employee.positionId);
  return position.permissions.includes(permission);
}

// Firestore Security Rules-д мөн адил шалгана:
// match /businesses/{bizId}/orders/{orderId} {
//   allow delete: if hasPermission(request.auth.uid, bizId, 'orders.delete');
// }
```

#### Олон бизнес дэх нэг хэрэглэгч
```
Хэрэглэгч "Бат":
├── Бизнес 1: "Эрээн Карго" → Эзэн (бүх эрхтэй)
├── Бизнес 2: "Мэндийн Шоп" → Менежер (хязгаарлагдсан эрхтэй)
└── Бизнес 3: "Болдын Хоол" → Хүргэгч (зөвхөн хүргэлт)

Бат нэвтрэхэд → Бизнес сонгох дэлгэц
эсвэл → Сүүлд ашигласан бизнес руу автомат орно
Дээд хэсэгт → Бизнес солигч байна
```

---

## 📦 МОДУЛЬ 5-12: (Үргэлжлэл)

Дараах модулиуд мөн адил нарийн төлөвлөгдөнө:

### МОДУЛЬ 5: ЗАХИАЛГЫН УДИРДЛАГА
- 5.1 Захиалга үүсгэх (ангилалд тохирсон form)
- 5.2 Захиалгын жагсаалт (хайлт, шүүлт, ангилал)
- 5.3 Захиалгын дэлгэрэнгүй
- 5.4 Статус удирдлага
- 5.5 Төлбөр бүртгэл
- 5.6 Bulk үйлдлүүд
- 5.7 Экспорт
- 5.8 Firestore schema + Security rules
- 5.9 Дэлгэц wireframe бүгд

### МОДУЛЬ 6: ХАРИЛЦАГЧИЙН УДИРДЛАГА
- 6.1-6.8 (адил нарийвчлалтай)

### МОДУЛЬ 7: БАРААНЫ КАТАЛОГ
- 7.1-7.10 (ангилалд тохирсон variant)

### МОДУЛЬ 8: DASHBOARD & ТАЙЛАН
- 8.1-8.6 (ангилалд тохирсон KPI)

### МОДУЛЬ 9: МЭДЭГДЛИЙН СИСТЕМ
- 9.1 Push notification (FCM)
- 9.2 In-app мэдэгдэл
- 9.3 Мэдэгдлийн тохиргоо

### МОДУЛЬ 10: ТОХИРГОО
- 10.1 Бизнес мэдээлэл
- 10.2 Захиалгын тохиргоо (статус, prefix, PIN)
- 10.3 Custom fields удирдлага
- 10.4 Ангилалын тусгай тохиргоо

### МОДУЛЬ 11: Landing PAGE & МАРКЕТИНГ
- 11.1 Нүүр хуудас
- 11.2 Үнийн хуудас
- 11.3 Холбоо барих

### МОДУЛЬ 12: ТӨЛБӨР & БАГЦ (Billing)
- 12.1 Багцын тодорхойлолт
- 12.2 Төлбөрийн flow
- 12.3 Хязгаарлалт хянах

---

## 🔄 ХӨГЖҮҮЛЭЛТИЙН МАРШРУТ (Шинэчилсэн)

### ҮЕ ШАТ 1: СУУРЬ
```
1.1 Vite + React + TypeScript + Firebase init
1.2 Дизайн систем (CSS variables, typography, components)
1.3 Router setup (public + protected routes)
1.4 Firebase Auth (утас + и-мэйл)
1.5 Layout (Sidebar, Header, BottomNav, responsive)
```

### ҮЕ ШАТ 2: БИЗНЕС + ЭРХ
```
2.1 Бизнес үүсгэх flow (нэр + ангилал)
2.2 Бизнес сонгогч (олон бизнес)
2.3 Permissions систем (hasPermission helper)
2.4 Default албан тушаалууд автомат үүсгэх
2.5 Албан тушаалын CRUD UI
2.6 Эрх тохируулах UI (checkbox grid)
2.7 Firestore Security Rules
```

### ҮЕ ШАТ 3: АЖИЛТАН
```
3.1 Ажилтан урих (утас + линк)
3.2 Урилга хүлээн авах flow
3.3 Ажилтнуудын жагсаалт
3.4 Ажилтны тушаал өөрчлөх
3.5 Ажилтан идэвхгүй/хасах
3.6 Бизнес хооронд шилжих
```

### ҮЕ ШАТ 4: ЗАХИАЛГЫН ЦӨМ
```
4.1 Захиалгын жагсаалт
4.2 Захиалга үүсгэх (ангилалд тохирсон form)
4.3 Захиалгын дэлгэрэнгүй
4.4 Статус удирдлага
4.5 Хайлт + шүүлтүүр
4.6 Төлбөр бүртгэл
4.7 PIN баталгаажуулалт (устгах)
```

### ҮЕ ШАТ 5: ХАРИЛЦАГЧ + БАРАА
```
5.1 Харилцагчийн CRUD
5.2 Барааны каталог (ангилалд тохирсон)
5.3 Захиалга-харилцагч-бараа холбоос
```

### ҮЕ ШАТ 6: DASHBOARD + ТАЙЛАН
```
6.1 KPI картууд
6.2 Графикууд
6.3 Экспорт
```

### ҮЕ ШАТ 7: МЭДЭГДЭЛ + ТОХИРГОО
```
7.1 Push notification
7.2 Custom fields
7.3 Бизнес тохиргоо
```

### ҮЕ ШАТ 8: DEPLOY
```
8.1 PWA
8.2 Landing page
8.3 Firebase Hosting → liscord.com
8.4 SSL
```

---

*Модуль 5-12 нарийн задаргааг DETAILED_PLAN_PART2.md файлд бичнэ.*
